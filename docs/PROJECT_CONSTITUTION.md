## PROJECT_CONSTITUTION

> 版本：v1.0  
> 更新时间：2025年 12月 16日 星期二 17:22:25 CST  
> 说明：本宪章基于当前 README、架构文档与设计文档的已知信息编写；如后续有权威信息更新，应以最新权威文件为准并同步修订。

---

### 1. 使命与愿景
- 面向工业自动化场景，提供分布式、高可用的 OPC UA 数据采集与分析能力，为 EMS/Web 监控中心持续输出低延迟、高完整性的数据服务。

### 2. 目标与约束
- **功能目标**  
  - 支持基于 OPC UA 的多 Tag 并发采集，主备冗余、故障自动切换。  
  - 提供实时/历史查询、告警、统计分析服务，通过 HTTP/WebSocket 暴露给上层 EMS/Web。  
  - 支持消息解耦（Kafka）、数据清洗、实时计算、批处理、缓存（Redis）与历史存储（MySQL）。
- **非功能性目标（当前基线，来自 README）**  
  - 采集延迟 \< 100ms；吞吐量 ≥ 10k msg/s（单节点）；可用性 ≥ 99.95%；故障恢复时间 \< 30s；数据完整性 ≥ 99.99%。  
  - 容器化部署（Docker/Compose），支持健康检查与运维脚本。
- **主要技术栈**  
  - C++17；open62541（OPC UA Client）；Kafka（librdkafka C++）；Redis 6.x；MySQL 8.0；epoll + Reactor；Protocol Buffers；spdlog；Docker/Compose。

### 3. 范围（In Scope）
- OPC UA 采集链路（基于 open62541）的构建、订阅管理、断线重连与主备切换。  
- 消息总线解耦（Kafka），数据清洗、实时计算、批处理。  
- Redis 缓存、MySQL 分表存储与批量写入。  
- 数据服务接口（查询、告警、统计）及监控/告警体系。  
- 容器化部署、一键启停、故障演练脚本。

### 4. 非范围（Out of Scope）
- 上层 EMS/Web UI 的具体界面实现。  
- 机器学习/预测性维护等高级算法细节（可在后续版本扩展）。  
- 与 OPC UA 无关的现场协议直连适配（当前通过 KepserverEx 网关统一为 OPC UA）。

### 5. 原则与优先级
- 正确性与可用性优先，其次是可观测性与可维护性，再次是性能与优雅性。  
- 遵循最小破坏、配置驱动、可回放与可追溯的设计。  
- 不引入与目标无关的重构或新技术栈；保持接口与命名稳定。

### 6. 交付物基线（当前已存在）
- `docs/architecture.md`：架构文档（分层与模块关系，不含实现）。  
- `docs/design/high_level_design.md`：高层设计文档（设计思路、概念数据结构、关键流程，无代码）。  
- `docs/planning/implementation_plan.md`：任务计划（阶段与可检验产出）。  
- `PROJECT_CONSTITUTION.md`：本宪章（当前版本）。  
- 状态快照与进度记录：`docs/snapshots/`、`project_progress.md`。

### 7. 里程碑与验收（摘要）
- 阶段 1：基于 open62541 的最小可用 OPC UA Client + Kafka 入队（含 Read/Write/订阅/重连验证）。  
- 阶段 2：清洗、Redis、MySQL 批量写入与基础查询验收。  
- 阶段 3：采集主备、高可用演练（含存储层 HA 基线）。  
- 阶段 4：告警与统计功能验收。  
- 阶段 5：监控与运维自动化验收。  
- 阶段 6：性能与长期稳定性验证。  
- 阶段 7：经验沉淀与持续改进。

### 8. 风险与待补充
- 现场实际设备规模、网络条件、采样策略仍需与业务侧确认。  
- 若后续提供权威的项目宪章或最新快照，需对本文件进行对齐和修订。  

### 9. 维护与变更
- 任何重大范围、目标或非功能指标的变更，应先更新本宪章，再同步到架构/设计/计划文档，并产出新的快照与进度记录。




